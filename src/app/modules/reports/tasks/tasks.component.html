<app-page-title title="Zadania pracowników"></app-page-title>
<div class="container-fluid">
  <div class="row filter-row">
    <div class="col-lg-3 pl-0 mr-5">
      <div>
        <span class="pr-2">Pracownik:</span>
        <p-dropdown
          [options]="employees"
          [(ngModel)]="selectedEmployeeId"
          filter="true"
          [style]="{ width: '100%' }"
        ></p-dropdown>
      </div>
      <div>
        <span class="pr-2">Projekt:</span>
        <p-dropdown
          [options]="projects"
          [(ngModel)]="selectedProjectId"
          filter="true"
          [style]="{ width: '100%' }"
          [virtualScroll]="true"
          [disabled]="isProjectsDropdownDisabled"
          (onChange)="onProjectsDropdownChange()"
        ></p-dropdown>
      </div>
      <div>
        <span class="pr-2">Zleceniodawca:</span>
        <p-dropdown
          [style]="{ width: '100%' }"
          [options]="customers"
          [(ngModel)]="selectedCustomerId"
          filter="true"
          [disabled]="isCustomersDropdownDisabled"
          (onChange)="onCustomersDropdownChange()"
        ></p-dropdown>
      </div>
      <div>
        <span class="pr-2">Stadium projektu:</span>
        <p-dropdown
          [style]="{ width: '100%' }"
          [options]="projectStages"
          [(ngModel)]="selectedProjectStageId"
        ></p-dropdown>
      </div>
    </div>
    <div class="col-lg-3 pl-0 mr-5">
      <div>
        <span class="pr-2">Kategoria:</span>
        <p-dropdown
          [options]="activityCategories"
          [(ngModel)]="selectedActivityCategoryId"
          [style]="{ width: '100%' }"
          (onChange)="onActivityCategoriesDropdownChange()"
        ></p-dropdown>
      </div>
      <div>
        <span class="pr-2">Podkategoria:</span>
        <p-dropdown
          [options]="activitySubcategories"
          [(ngModel)]="selectedActivitySubcategoryId"
          [style]="{ width: '100%' }"
          [disabled]="isActivitySubcategoriesDropdownDisabled"
          (onChange)="onActivitySubcategoriesDropdownChange()"
        ></p-dropdown>
      </div>
      <div>
        <span class="pr-2">Element:</span>
        <p-dropdown
          [options]="activityElements"
          [(ngModel)]="selectedActivityElementId"
          [style]="{ width: '100%' }"
          [disabled]="isActivityElementsDropdownDisabled"
        ></p-dropdown>
      </div>
      <div>
        <span class="pr-2">Program:</span>
        <p-dropdown
          [options]="softwares"
          [(ngModel)]="selectedSoftwaresId"
          [style]="{ width: '100%' }"
          [disabled]="isSoftwareDropdownDisabled"
        ></p-dropdown>
      </div>
    </div>
    <div class="col-lg-3 pl-0 mr-5">
      <div>
        <span class="pr-2">Data od:</span>
        <p-calendar
          [style]="{ width: '100%' }"
          [inputStyle]="{ width: '100%' }"
          [maxDate]="maxDate"
          [(ngModel)]="selectedStartTime"
          (ngModelChange)="onSelectedStartTimeChanged($event)"
        ></p-calendar>
      </div>
      <div>
        <span class="pr-2">Data do:</span>
        <p-calendar
          [style]="{ width: '100%' }"
          [inputStyle]="{ width: '100%' }"
          [minDate]="minDate"
          [(ngModel)]="selectedEndTime"
          (ngModelChange)="onSelectedEndTimeChanged($event)"
        ></p-calendar>
      </div>
    </div>
    <div class="col-lg-3 pl-0 mr-5">
      <div class="row">
        <div class="col">
          <span class="pr-2">Koszty:</span>
          <p-checkbox [(ngModel)]="isAddCost" [binary]="true"> </p-checkbox>
        </div>
        <div class="col">
          <span class="pr-2">Błędy:</span>
          <p-checkbox [(ngModel)]="isMistake" [binary]="true"> </p-checkbox>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-3">
    <button mat-raised-button color="primary" (click)="onShowResultsClick()">
      Pokaż wyniki
    </button>
  </div>
  <div class="row mt-3">
    <div class="col p-0" *ngIf="employeeTasks">
      <p-table
        #employeeTaskTable
        [columns]="columns"
        [value]="employeeTasks"
        [paginator]="true"
        [rows]="50"
      >
        <ng-template pTemplate="header" let-column>
          <tr>
            <th colspan="14">Suma czasu: {{ totalHours | number }} h</th>
          </tr>
          <tr>
            <th style="width: 150px; min-width: 150px">Pracownik</th>
            <th style="width: 120px; min-width: 120px">Nr projektu</th>
            <th style="width: 150px; min-width: 150px">Zleceniodawca</th>
            <th style="width: 150px; min-width: 150px">Nazwa projektu</th>
            <th style="width: 150px; min-width: 150px">Stadium projektu</th>
            <th style="width: 150px; min-width: 150px">Kategoria</th>
            <th style="width: 150px; min-width: 150px">Podkategoria</th>
            <th style="width: 150px; min-width: 150px">Element</th>
            <th style="width: 100px; min-width: 100px">Program</th>
            <th style="width: 100px; min-width: 100px">Koszty</th>
            <th style="width: 100px; min-width: 100px">Błędy</th>
            <th style="width: 120px; min-width: 120px">Czas startu</th>
            <th style="width: 120px; min-width: 120px">Czas końca</th>
            <th rowspan="2">Godziny</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-employeeTask>
          <tr>
            <td style="width: 150px; min-width: 150px">
              {{ employeeTask?.employeeName }}
            </td>
            <td style="width: 120px; min-width: 120px">
              {{ employeeTask?.projectNumber }}
            </td>
            <td style="width: 150px; min-width: 150px">
              {{ employeeTask?.customerName }}
            </td>
            <td style="width: 150px; min-width: 150px">
              {{ employeeTask?.projectName }}
            </td>
            <td style="width: 150px; min-width: 150px">
              {{ employeeTask?.projectStageName }}
            </td>
            <td style="width: 150px; min-width: 150px">
              {{ employeeTask?.firstActivity }}
            </td>
            <td style="width: 150px; min-width: 150px">
              {{ employeeTask?.secondActivity }}
            </td>
            <td style="width: 150px; min-width: 150px">
              {{ employeeTask?.thirdActivity }}
            </td>
            <td style="width: 100px; min-width: 100px">
              {{ employeeTask?.software }}
            </td>
            <td style="width: 100px; min-width: 100px">
              {{ employeeTask?.isAdditionalCost }}
            </td>
            <td style="width: 100px; min-width: 100px">
              {{ employeeTask?.isMistake }}
            </td>
            <td style="width: 120px; min-width: 120px">
              {{ employeeTask?.startTime.replace("T", " ") }}
            </td>
            <td style="width: 120px; min-width: 120px">
              {{ employeeTask?.endTime.replace("T", " ") }}
            </td>
            <td>
              {{ employeeTask?.hours }}
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="loadingbody" let-columns="columns">
          <tr style="height: 34px">
            <td *ngFor="let col of columns">
              <div class="loading-text"></div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
